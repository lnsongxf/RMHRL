function equ = RSP_focs(par00, Gridphi,fspace);

global alpha betta sig epsil nu nu2 ;
global s1 s2 elast1 elast2 delta1 delta2

par0 = reshape(par00,length(par00)/9,9 );

parlambda1 =               par0(:,1);
para1 =                         par0(:,2);
parexp1 =                     par0(:,3);
parexp2 =                     par0(:,4);
parlambda2 =               par0(:,5);
para2 =                     par0(:,6);
parexp_planner1 =      par0(:,7);
park1 =                           par0(:,8);
park2 =                     par0(:,9);


a1 =                     funeval(para1,fspace, Gridphi);
a2 =                     funeval(para2,fspace, Gridphi);
lambda1 = funeval(parlambda1,fspace, Gridphi);
lambda2 = funeval(parlambda2,fspace, Gridphi);
k1_next = funeval(park1,fspace, Gridphi);
k2_next = funeval(park2,fspace, Gridphi);


phi1 = Gridphi(:,1);
k1  = Gridphi(:,2);
k2 = Gridphi(:,3);




aggr_output = zeros(length(Gridphi),4);
aggr_output(:,1) = - k1_next - k2_next +  (1-delta1).*Gridphi(:,2) + (1-delta2).*Gridphi(:,3)  +...
    s1(2).*(Gridphi(:,2).^elast1) + s2(2).*(Gridphi(:,3).^elast2);
aggr_output(:,2) = - k1_next - k2_next +  (1-delta1).*Gridphi(:,2) + (1-delta2).*Gridphi(:,3)  +...
    s1(1).*(Gridphi(:,2).^elast1) + s2(2).*(Gridphi(:,3).^elast2);
aggr_output(:,3) = - k1_next - k2_next +  (1-delta1).*Gridphi(:,2) + (1-delta2).*Gridphi(:,3)  +...
    s1(2).*(Gridphi(:,2).^elast1) + s2(1).*(Gridphi(:,3).^elast2);
aggr_output(:,4) = - k1_next - k2_next +  (1-delta1).*Gridphi(:,2) + (1-delta2).*Gridphi(:,3)  +...
    s1(1).*(Gridphi(:,2).^elast1) + s2(1).*(Gridphi(:,3).^elast2);
aggr_y   = aggr_output(:,4);

c1 = aggr_y./(  1+ phi1.^(1/sig));
c2 = aggr_y - c1;

c1_s1s2 = aggr_output(:,2)./(  1+ phi1.^(1/sig)); %;
c1_s2s1 = aggr_output(:,3)./(  1+ phi1.^(1/sig)); %;
c1_s2s2 = aggr_output(:,1)./(  1+ phi1.^(1/sig)); %;

c2_s1s2 = aggr_output(:,2) - c1_s1s2 ;
c2_s2s1 = aggr_output(:,3) - c1_s2s1 ;
c2_s2s2 = aggr_output(:,1) - c1_s2s2 ;



% probabilities
prob1_s1 =  a1.^nu;
prob1_s2 = 1 - prob1_s1;

dprob1_s1 =  nu.*(a1.^(nu-1));
dprob1_s2 =  - dprob1_s1;


% probabilities

prob2_s2 = (1 - a2.^nu2);
prob2_s1 = (a2.^nu2);

dprob2_s2 =  (-nu2.*(a2.^(nu2-1)));
dprob2_s1 =  (nu2.*(a2.^(nu2-1)));


% likelihood ratios
like_ratio1_s1 =  dprob1_s1./prob1_s1;
like_ratio1_s2 = dprob1_s2./prob1_s2;

like_ratio2_s1 =  dprob2_s1./prob2_s1;
like_ratio2_s2 = dprob2_s2./prob2_s2;


% derivatives of likelihood ratios
dlike_ratio1_s1 =  -nu./(a1.^2);%
dlike_ratio1_s2 = (-nu*(nu-1)*(a1.^(nu-2)) - nu*(a1.^(2*nu-2)))./(prob1_s2.^2) ;


dlike_ratio2_s2 =  ((-nu2*(nu2-1)*(a2.^(nu2-2)) - nu2*(a2.^(2*nu2-2)))./(prob2_s2.^2)) ;%
dlike_ratio2_s1 = ( -nu2./(a2.^2))  ;




PHINext_s1s1 = phi1.*(1+lambda2.*like_ratio2_s1)./(1+lambda1.*like_ratio1_s1);
PHINext_s1s2 = phi1.*(1+lambda2.*like_ratio2_s2)./(1+lambda1.*like_ratio1_s1);
PHINext_s2s1 = phi1.*(1+lambda2.*like_ratio2_s1)./(1+lambda1.*like_ratio1_s2);
PHINext_s2s2 = phi1.*(1+lambda2.*like_ratio2_s2)./(1+lambda1.*like_ratio1_s2);



k1_nextNext_s1s1= funeval(park1,fspace,[PHINext_s1s1 k1_next k2_next]);
k1_nextNext_s1s2= funeval(park1,fspace,[PHINext_s1s2 k1_next k2_next]);
k1_nextNext_s2s1= funeval(park1,fspace,[PHINext_s2s1 k1_next k2_next]);
k1_nextNext_s2s2= funeval(park1,fspace,[PHINext_s2s2 k1_next k2_next]);

k2_nextNext_s1s1= funeval(park2,fspace,[PHINext_s1s1 k1_next k2_next]);
k2_nextNext_s1s2= funeval(park2,fspace,[PHINext_s1s2 k1_next k2_next]);
k2_nextNext_s2s1= funeval(park2,fspace,[PHINext_s2s1 k1_next k2_next]);
k2_nextNext_s2s2= funeval(park2,fspace,[PHINext_s2s2 k1_next k2_next]);


aggr_output_Next = zeros(length(Gridphi),4);
aggr_output_Next(:,1) = - k1_nextNext_s2s2 - k2_nextNext_s2s2...
    +  (1-delta1).*k1_next + (1-delta2).*k2_next  +...
    s1(2).*(k1_next.^elast1) + s2(2).*(k2_next.^elast2);
aggr_output_Next(:,2) = - k1_nextNext_s1s2 - k2_nextNext_s1s2...
    +  (1-delta1).*k1_next + (1-delta2).*k2_next  +...
    s1(1).*(k1_next.^elast1) + s2(2).*(k2_next.^elast2);
aggr_output_Next(:,3) = - k1_nextNext_s2s1 - k2_nextNext_s2s1...
    +  (1-delta1).*k1_next + (1-delta2).*k2_next  +...
    s1(2).*(k1_next.^elast1) + s2(1).*(k2_next.^elast2);
aggr_output_Next(:,4) =- k1_nextNext_s1s1 - k2_nextNext_s1s1...
    +  (1-delta1).*k1_next + (1-delta2).*k2_next  +...
    s1(1).*(k1_next.^elast1) + s2(1).*(k2_next.^elast2);



c1Next_s1s1 = aggr_output_Next(:,4)./(1+PHINext_s1s1.^(1/sig)); %
c1Next_s1s2 = aggr_output_Next(:,2)./(1+PHINext_s1s2.^(1/sig)); %
c1Next_s2s1 = aggr_output_Next(:,3)./(1+PHINext_s2s1.^(1/sig)); %
c1Next_s2s2 = aggr_output_Next(:,1)./(1+PHINext_s2s2.^(1/sig)); %

c2Next_s1s1 = aggr_output_Next(:,4)-c1Next_s1s1; %
c2Next_s1s2 = aggr_output_Next(:,2)-c1Next_s1s2; %
c2Next_s2s1 = aggr_output_Next(:,3)-c1Next_s2s1; %
c2Next_s2s2 = aggr_output_Next(:,1)-c1Next_s2s2; %




a1Next_s1s1 = funeval(para1,fspace,[PHINext_s1s1 k1_next k2_next]);
a1Next_s1s2 = funeval(para1,fspace,[PHINext_s1s2  k1_next k2_next]);
a1Next_s2s1 = funeval(para1,fspace,[PHINext_s2s1 k1_next k2_next]);
a1Next_s2s2 = funeval(para1,fspace,[PHINext_s2s2   k1_next k2_next]);
%
a2Next_s1s1 = funeval(para2,fspace,[PHINext_s1s1  k1_next k2_next]);
a2Next_s1s2 = funeval(para2,fspace,[PHINext_s1s2  k1_next k2_next]);
a2Next_s2s1 = funeval(para2,fspace,[PHINext_s2s1 k1_next k2_next]);
a2Next_s2s2 = funeval(para2,fspace,[PHINext_s2s2  k1_next k2_next]);




lambda1Next_s1s1 = funeval(parlambda1,fspace,[PHINext_s1s1  k1_next k2_next]);
lambda1Next_s1s2 = funeval(parlambda1,fspace,[PHINext_s1s2  k1_next k2_next]);
lambda1Next_s2s1 = funeval(parlambda1,fspace,[PHINext_s2s1  k1_next k2_next]);
lambda1Next_s2s2 = funeval(parlambda1,fspace,[PHINext_s2s2  k1_next k2_next]);
%
lambda2Next_s1s1 = funeval(parlambda2,fspace,[PHINext_s1s1  k1_next k2_next]);
lambda2Next_s1s2 = funeval(parlambda2,fspace,[PHINext_s1s2  k1_next k2_next]);
lambda2Next_s2s1 = funeval(parlambda2,fspace,[PHINext_s2s1  k1_next k2_next]);
lambda2Next_s2s2 = funeval(parlambda2,fspace,[PHINext_s2s2  k1_next k2_next]);


if sig==1
    utilityNext1_s1s1 = log(c1Next_s1s1) - alpha*(a1Next_s1s1.^epsil) ;
    utilityNext1_s2s1 = log(c1Next_s2s1) - alpha*(a1Next_s2s1.^epsil) ;
    utilityNext1_s1s2 = log(c1Next_s1s2) - alpha*(a1Next_s1s2.^epsil) ;
    utilityNext1_s2s2 = log(c1Next_s2s2) - alpha*(a1Next_s2s2.^epsil) ;

    utilityNext2_s1s1 = log(c2Next_s1s1) - alpha*(a2Next_s1s1.^epsil);
    utilityNext2_s2s1 = log(c2Next_s2s1) - alpha*(a2Next_s2s1.^epsil);
    utilityNext2_s1s2 = log(c2Next_s1s2) - alpha*(a2Next_s1s2.^epsil);
    utilityNext2_s2s2 = log(c2Next_s2s2) - alpha*(a2Next_s2s2.^epsil);

else

    utilityNext1_s1s1 = (c1Next_s1s1.^(1-sig))./(1-sig)  - alpha*(a1Next_s1s1.^epsil) ;
    utilityNext1_s2s1 = (c1Next_s2s1.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s1.^epsil) ;
    utilityNext1_s1s2 = (c1Next_s1s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s1s2.^epsil) ;
    utilityNext1_s2s2 = (c1Next_s2s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s2.^epsil) ;

    utilityNext2_s1s1 = (c2Next_s1s1.^(1-sig))./(1-sig)  - alpha*(a2Next_s1s1.^epsil);
    utilityNext2_s2s1 = (c2Next_s2s1.^(1-sig))./(1-sig)  - alpha*(a2Next_s2s1.^epsil);
    utilityNext2_s1s2 = (c2Next_s1s2.^(1-sig))./(1-sig)  - alpha*(a2Next_s1s2.^epsil);
    utilityNext2_s2s2 = (c2Next_s2s2.^(1-sig))./(1-sig)  - alpha*(a2Next_s2s2.^epsil);


end;


exp_disc_utility1 = funeval(parexp1,fspace,Gridphi);
exp_disc_utility1_next_s1s1 = funeval(parexp1,fspace,[PHINext_s1s1  k1_next k2_next] );
exp_disc_utility1_next_s1s2 = (c1Next_s1s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s1s2.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) +  alpha*(a1Next_s1s1.^epsil) ...
    +funeval(parexp1,fspace,[PHINext_s1s2  k1_next k2_next] );
exp_disc_utility1_next_s2s1 = (c1Next_s2s1.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s1.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) +  alpha*(a1Next_s1s1.^epsil) + ...
    funeval(parexp1,fspace,[PHINext_s2s1  k1_next k2_next]  );
exp_disc_utility1_next_s2s2 =  (c1Next_s2s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s2.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) +  alpha*(a1Next_s1s1.^epsil) + ...
    funeval(parexp1,fspace,[PHINext_s2s2  k1_next k2_next] );

exp_disc_utility2 = funeval(parexp2,fspace,Gridphi);
exp_disc_utility2_next_s1s1 =  funeval(parexp2,fspace,[PHINext_s1s1  k1_next k2_next]);
exp_disc_utility2_next_s1s2 = (c2Next_s1s2.^(1-sig))./(1-sig)  - alpha*(a2Next_s1s2.^epsil) ...
    - (c2Next_s1s1.^(1-sig))./(1-sig) + alpha*(a2Next_s1s1.^epsil) + ...
    funeval(parexp2,fspace,[PHINext_s1s2  k1_next k2_next]  );
exp_disc_utility2_next_s2s1 =  (c2Next_s2s1.^(1-sig))./(1-sig)  - alpha*(a2Next_s2s1.^epsil) ...
    - (c2Next_s1s1.^(1-sig))./(1-sig) + alpha*(a2Next_s1s1.^epsil) + ...
    funeval(parexp2,fspace,[PHINext_s2s1  k1_next k2_next] );
exp_disc_utility2_next_s2s2 =  (c2Next_s2s2.^(1-sig))./(1-sig)  - alpha*(a2Next_s2s2.^epsil) ...
    - (c2Next_s1s1.^(1-sig))./(1-sig) + alpha*(a2Next_s1s1.^epsil) + ...
    funeval(parexp2,fspace,[PHINext_s2s2  k1_next k2_next] );


exp_planner_disc_utility = funeval(parexp_planner1,fspace,Gridphi);
exp_planner_disc_utility_next_s1s1 = funeval(parexp_planner1,fspace,[PHINext_s1s1  k1_next k2_next]  );
exp_planner_disc_utility_next_s1s2 =  (c1Next_s1s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s1s2.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) + alpha*(a1Next_s1s1.^epsil) + ...
    - epsil*alpha.*(a1Next_s1s1.^(epsil-1)).*lambda1Next_s1s1 ...
    + epsil*alpha.*(a1Next_s1s2.^(epsil-1)).*lambda1Next_s1s2 + ...
    + PHINext_s1s1.*(epsil*alpha.*(a2Next_s1s1.^(epsil-1)).*lambda2Next_s1s1) ...
    - PHINext_s1s2.*(epsil*alpha.*(a2Next_s1s2.^(epsil-1)).*lambda2Next_s1s2) + ...
    PHINext_s1s2.*((c2Next_s1s2.^(1-sig))./(1-sig) - alpha*(a2Next_s1s2.^epsil))...
    - PHINext_s1s1.*((c2Next_s1s1.^(1-sig))./(1-sig) -  alpha*(a2Next_s1s1.^epsil))+ ...
    funeval(parexp_planner1,fspace,[PHINext_s1s2  k1_next k2_next]  );
exp_planner_disc_utility_next_s2s1 = (c1Next_s2s1.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s1.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) + alpha*(a1Next_s1s1.^epsil)  ...
    - epsil*alpha.*(a1Next_s1s1.^(epsil-1)).*lambda1Next_s1s1 ...
    + epsil*alpha.*(a1Next_s2s1.^(epsil-1)).*lambda1Next_s2s1  ...
    + PHINext_s1s1.*(epsil*alpha.*(a2Next_s1s1.^(epsil-1)).*lambda2Next_s1s1) ...
    - PHINext_s2s1.*(epsil*alpha.*(a2Next_s2s1.^(epsil-1)).*lambda2Next_s2s1)  ...
    +PHINext_s2s1.*((c2Next_s2s1.^(1-sig))./(1-sig) - alpha*(a2Next_s2s1.^epsil))...
    - PHINext_s1s1.*((c2Next_s1s1.^(1-sig))./(1-sig) -  alpha*(a2Next_s1s1.^epsil))+ ...
    funeval(parexp_planner1,fspace,[PHINext_s2s1  k1_next k2_next]  );
exp_planner_disc_utility_next_s2s2 =  (c1Next_s2s2.^(1-sig))./(1-sig)  - alpha*(a1Next_s2s2.^epsil) ...
    - (c1Next_s1s1.^(1-sig))./(1-sig) + alpha*(a1Next_s1s1.^epsil) + ...
    - epsil*alpha.*(a1Next_s1s1.^(epsil-1)).*lambda1Next_s1s1 ...
    + epsil*alpha.*(a1Next_s2s2.^(epsil-1)).*lambda1Next_s2s2  ...
    + PHINext_s1s1.*(epsil*alpha.*(a2Next_s1s1.^(epsil-1)).*lambda2Next_s1s1) ...
    - PHINext_s2s2.*(epsil*alpha.*(a2Next_s2s2.^(epsil-1)).*lambda2Next_s2s2) + ...
    PHINext_s2s2.*((c2Next_s2s2.^(1-sig))./(1-sig) - alpha*(a2Next_s2s2.^epsil))...
    - PHINext_s1s1.*((c2Next_s1s1.^(1-sig))./(1-sig) -  alpha*(a2Next_s1s1.^epsil))+ ...
    funeval(parexp_planner1,fspace,[PHINext_s2s2  k1_next k2_next]  );




%%%%%%%%
%                       %
% EQUATIONS  %
%                       %
%%%%%%%%



% FOC a1
equ1 = epsil*alpha.*(a1.^(epsil-1))  -   prob2_s1.*(betta.*dprob1_s1.*exp_disc_utility1_next_s1s1 ...
    +  betta.*dprob1_s2.*exp_disc_utility1_next_s2s1) - ...
    prob2_s2.*(betta.*dprob1_s1.*exp_disc_utility1_next_s1s2 ...
    +  betta.*dprob1_s2.*exp_disc_utility1_next_s2s2) ;


equ1bis = epsil*alpha.*(a2.^(epsil-1)) -   prob1_s1.*(betta.*dprob2_s1.*exp_disc_utility2_next_s1s1  ...
    +  betta.*dprob2_s2.*exp_disc_utility2_next_s1s2) ...
    -   prob1_s2.*(betta.*dprob2_s1.*exp_disc_utility2_next_s2s1  ...
    +  betta.*dprob2_s2.*exp_disc_utility2_next_s2s2) ;



% dynamic equat. for exp_disc_utility1
if sig==1
    equ2 = exp_disc_utility1 - log(c1) ...
        + alpha.*(a1.^epsil) ...
        -  betta.*prob2_s1.*(prob1_s1.*exp_disc_utility1_next_s1s1 ...
        +  prob1_s2.*exp_disc_utility1_next_s2s1 )...
        -  betta.*prob2_s2.*(prob1_s1.*exp_disc_utility1_next_s1s2 ...
        +  prob1_s2.*exp_disc_utility1_next_s2s2 );

    equ3 = exp_disc_utility2 - log(c2) ...
        + alpha.*(a2.^epsil) ...
        -  betta.*prob2_s1.*(prob1_s1.*exp_disc_utility2_next_s1s1 ...
        + prob1_s2.*exp_disc_utility2_next_s2s1 )...
        -  betta.*prob2_s2.*(prob1_s1.*exp_disc_utility2_next_s1s2 ...
        +  prob1_s2.*exp_disc_utility2_next_s2s2 );

else

    equ2 = exp_disc_utility1 - (c1.^(1-sig))./(1-sig) ...
        + alpha.*(a1.^epsil) ...
        -  betta.*prob2_s1.*(prob1_s1.*exp_disc_utility1_next_s1s1 ...
        +  prob1_s2.*exp_disc_utility1_next_s2s1 )...
        -  betta.*prob2_s2.*(prob1_s1.*exp_disc_utility1_next_s1s2 ...
        +  prob1_s2.*exp_disc_utility1_next_s2s2 );

    equ3 = exp_disc_utility2 - (c2.^(1-sig))./(1-sig) ...
        + alpha.*(a2.^epsil) ...
        -  betta.*prob2_s1.*(prob1_s1.*exp_disc_utility2_next_s1s1 ...
        +  prob1_s2.*exp_disc_utility2_next_s2s1 )...
        -  betta.*prob2_s2.*(prob1_s1.*exp_disc_utility2_next_s1s2 ...
        + prob1_s2.*exp_disc_utility2_next_s2s2 );
end;


% FOC a1
incent1 =  -epsil*alpha.*(a1.^(epsil-1)) - epsil*(epsil-1)*alpha.*(a1.^(epsil-2)).*lambda1 ...
    +  betta.*lambda1.*prob2_s1.*(prob1_s1.*dlike_ratio1_s1.*exp_disc_utility1_next_s1s1 ...
    + prob1_s2.*dlike_ratio1_s2.*exp_disc_utility1_next_s2s1) ...
    +  betta.*lambda1.*prob2_s2.*(prob1_s1.*dlike_ratio1_s1.*exp_disc_utility1_next_s1s2 ...
    + prob1_s2.*dlike_ratio1_s2.*exp_disc_utility1_next_s2s2) ;

incent2 =  -epsil*alpha.*(a2.^(epsil-1)) - epsil*(epsil-1)*alpha.*(a2.^(epsil-2)).*lambda2 ...
    +  betta.*lambda2.*prob2_s1.*(prob1_s1.*dlike_ratio2_s1.*exp_disc_utility2_next_s1s1 ...
    + prob1_s2.*dlike_ratio2_s1.*exp_disc_utility2_next_s2s1) ...
    +  betta.*lambda2.*prob2_s2.*(prob1_s1.*dlike_ratio2_s2.*exp_disc_utility2_next_s1s2 ...
    + prob1_s2.*dlike_ratio2_s2.*exp_disc_utility2_next_s2s2) ;

equ4 =  - phi1.*incent2 ...
    - betta.*dprob2_s1.*(prob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s1 ...
    +  prob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s1 )...
    -  betta.*dprob2_s2.*(prob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s2 ...
    +  prob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s2 );

equ5 = exp_planner_disc_utility  - (c1.^(1-sig))./(1-sig) + alpha.*(a1.^epsil) + epsil*alpha.*(a1.^(epsil-1)).*lambda1  ...
    - phi1.*((c2.^(1-sig))./(1-sig) - alpha.*(a2.^epsil)  - epsil*alpha.*(a2.^(epsil-1)).*lambda2 ) ...
    -  betta.*prob2_s1.*(prob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s1 ...
    +  prob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s1 )...
    -  betta.*prob2_s2.*(prob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s2 ...
    +  prob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s2 );

equ6 = -incent1 ...
    - betta.*prob2_s1.*(dprob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s1 ...
    +  dprob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s1 )...
    -  betta.*prob2_s2.*(dprob1_s1.*(1+lambda1.*like_ratio1_s1).*exp_planner_disc_utility_next_s1s2 ...
    +  dprob1_s2.*(1+lambda1.*like_ratio1_s2).*exp_planner_disc_utility_next_s2s2 );



equ7 =   - (c1.^(-sig)) ...
    +  betta.*prob2_s1.*(prob1_s1.*((1-delta1)+s1(1).*elast1.*(k1_next.^(elast1-1)))...
    .*(1+lambda1.*like_ratio1_s1).*(c1Next_s1s1.^(-sig)) ...
    + prob1_s2.*((1-delta1)+s1(2).*elast1.*(k1_next.^(elast1-1))).*...
    (1+lambda1.*like_ratio1_s2).*(c1Next_s2s1.^(-sig))) ...
    +  betta.*prob2_s2.*(prob1_s1.*((1-delta1)+s1(1).*elast1.*(k1_next.^(elast1-1)))...
    .*(1+lambda1.*like_ratio1_s1).*(c1Next_s1s2.^(-sig)) ...
    + prob1_s2.*((1-delta1)+s1(2).*elast1.*(k1_next.^(elast1-1))).*(1+lambda1.*like_ratio1_s2)...
    .*(c1Next_s2s2.^(-sig))) ;

equ8 =   - (c2.^(-sig)) ...
    +  betta.*((1-delta2)+s2(1).*elast2.*(k2_next.^(elast2-1))).*prob2_s1.*(prob1_s1.*...
    (1+lambda2.*like_ratio2_s1).*(c2Next_s1s1.^(-sig)) ...
    + prob1_s2.*(1+lambda2.*like_ratio2_s1).*(c2Next_s2s1.^(-sig))) ...
    +  betta.*((1-delta2)+s2(2).*elast2.*(k2_next.^(elast2-1))).*prob2_s2.*(prob1_s1.*...
    (1+lambda2.*like_ratio2_s2).*(c2Next_s1s2.^(-sig)) ...
    + prob1_s2.*(1+lambda2.*like_ratio2_s2).*(c2Next_s2s2.^(-sig))) ;


equ = [equ1; equ1bis; equ2; equ3;  equ4;equ5; equ6; equ7; equ8] ;


if(any(a1<0)) || (any(c1<0))  ||(any(a1>1))  || (any(k1_next<0))    || (any(k2_next<0)) || ...
        (any(c2<0))  || (any(a2<0))   ||(any(a2>1)) ||  (any( lambda1<0))  ||  (any( lambda2<0))
    equ(1) = 1e100;
end;